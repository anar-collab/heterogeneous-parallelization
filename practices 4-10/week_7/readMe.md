Тема: Реализация редукции и префиксной суммы на GPU с использованием CUDA
1. Теоретическая часть
1.1. Редукция

Редукция — это параллельная операция, при которой множество элементов массива сводится к одному значению с использованием ассоциативной операции.
Наиболее распространённый пример — суммирование элементов массива.

Применение редукции:

вычисление суммы;

поиск максимума или минимума;

вычисление среднего значения;

агрегирование данных.

В CUDA редукция реализуется поэтапно:

Загрузка данных из глобальной памяти.

Частичная редукция внутри блока с использованием разделяемой памяти.

Объединение результатов от всех блоков.

1.2. Префиксная сумма (Scan)

Префиксная сумма (scan) — это операция, при которой каждый элемент выходного массива содержит сумму всех предыдущих элементов входного массива.

Формально:

output[i] = input[0] + input[1] + ... + input[i]


Сканирование используется в задачах:

сортировки;

фильтрации данных;

построения гистограмм;

обработки графов;

параллельных алгоритмов.

В CUDA префиксная сумма обычно реализуется в два этапа:

Up-sweep (reduce phase) — построение дерева сумм.

Down-sweep — распространение частичных сумм.

2. Практическая часть
2.1. Реализация редукции

В рамках работы было реализовано CUDA-ядро, выполняющее суммирование элементов массива с использованием разделяемой памяти.

Основные этапы выполнения:

Выделение памяти на CPU и GPU.

Копирование входных данных на GPU.

Загрузка данных в shared memory.

Параллельное суммирование внутри блока.

Запись частичных сумм.

Финальная редукция результатов.

Сравнение с CPU-реализацией.

2.2. Реализация префиксной суммы

Для реализации префиксной суммы был использован алгоритм Blelloch scan.

Этапы алгоритма:

загрузка данных в разделяемую память;

выполнение up-sweep фазы;

выполнение down-sweep фазы;

запись результата в глобальную память.

Результаты GPU-реализации были проверены путём сравнения с последовательной CPU-реализацией.

2.3. Анализ производительности

Тестирование проводилось для массивов следующих размеров:

1024 элементов;

1 000 000 элементов;

10 000 000 элементов.

Методика измерения:

для CPU использовался std::chrono;

для GPU применялись cudaEvent_t.

Общие результаты:

для малых массивов CPU работает быстрее из-за накладных расходов на запуск CUDA-ядра;

при увеличении размера массива GPU показывает значительное ускорение;

использование разделяемой памяти существенно снижает количество обращений к глобальной памяти.

3. Выводы

GPU показывает значительное преимущество при работе с большими объёмами данных.

Использование разделяемой памяти является ключевым фактором оптимизации.

Редукция проще в реализации, но префиксная сумма более универсальна.

Оптимизация CUDA-программ начинается с анализа доступа к памяти.

Для достижения максимальной производительности важно правильно подбирать размеры блоков и сетки.

4. Контрольные вопросы
1. В чём разница между редукцией и сканированием?

Редукция сводит массив к одному значению (например, сумма), тогда как сканирование формирует массив частичных результатов, где каждый элемент зависит от предыдущих.

2. Какие типы памяти CUDA используются для оптимизации редукции и сканирования?

Основные типы памяти:

Глобальная память — основное хранилище данных, высокая задержка.

Разделяемая память (shared memory) — быстрая память внутри блока.

Регистры — самая быстрая память, используется для временных переменных.

Константная память — для неизменяемых данных.

Наибольшее ускорение достигается за счёт использования разделяемой памяти.

3. Как можно оптимизировать префиксную сумму на GPU?

Основные методы оптимизации:

использование разделяемой памяти;

уменьшение числа глобальных обращений;

устранение расхождений варпов;

обработка нескольких элементов одним потоком;

многоуровневое сканирование для больших массивов.

4. Приведите пример задачи, где применяется сканирование.

Префиксная сумма применяется в:

параллельной сортировке (Radix Sort);

фильтрации массивов;

построении гистограмм;

обработке графов;

моделировании физических процессов.

✅ ИТОГ

В ходе практической работы были реализованы и исследованы два важных параллельных алгоритма — редукция и префиксная сумма. Проведён анализ производительности и показано преимущество GPU при работе с большими объёмами данных.